(window.webpackJsonp=window.webpackJsonp||[]).push([[45],{626:function(t,e,r){"use strict";r.r(e);var n=r(4),l=(r(16),r(447),r(93),r(33),r(92)),o=r.n(l),c=r(610),d=r(546),m=r.n(d),v={layout:"adminLte",head:function(){return{title:"Dashboard | Support",link:[{rel:"stylesheet",href:"https://fonts.googleapis.com/icon?family=Material+Icons"}],script:[{src:"/assets/Modernize/js/apps/chat.js",body:!0},{src:"/assets/Modernize/vendor/fullcalendar/index.global.min.js",defer:!0,body:!0,callback:this.onScriptLoaded},{src:"https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js",defer:!0,body:!0,callback:this.onScriptLoaded},{src:"https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js",body:!0,skip:!this.externalLoaded}]}},name:"usertype",data:function(){return{link:"/branch/api/chats",dataTable:null,stompClient:null,me:2,room:null,message:null,roomId:null,chatListing:[],load:!1,listing:[]}},mounted:function(){var t=this;return Object(n.a)(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:e.next=2;break;case 2:if(t.roomId=t.$route.params.id,!t.roomId){e.next=9;break}return t.initiateSocket(t.roomId),e.next=7,t.getAll();case 7:e.next=11;break;case 9:return e.next=11,t.getAll();case 11:case"end":return e.stop()}}),e)})))()},component:{},methods:{ago:function(t){var e=new Date,r=new Date(t),n=e.getTime()-r.getTime(),l=n/1e3,o=l/60,c=o/60,d=c/24;return l<60?"".concat(Math.floor(l)," seconds ago"):o<60?"".concat(Math.floor(o)," minutes ago"):c<24?"".concat(Math.floor(c)," hours ago"):d<7?"".concat(Math.floor(d)," days ago"):"".concat(new Date(n).toISOString().substr(11,8))},getAll:function(){var t=this;o.a.all([o.a.get(this.link+"/allrooms",this.config)]).then(o.a.spread((function(e){t.listing=e.data.response,1==e.data.success&&setTimeout((function(){t.load=!0}),500)})))},getMessages:function(t){var e=this;o.a.get(this.link+"/byRoomID?roomId="+t.chatRoomId+"&receiver="+this.me,this.config).then((function(r){if(r.data.success){var n=r.data.response;e.chatListing=n||[],e.roomId=t.chatRoomId,e.room=t,e.initiateSocket(t.chatRoomId)}else e.$toast.error(r.data.message).goAway(1500)})).catch((function(t){e.$toast.error(t.response.data.messageText).goAway(1500)}))},initiateSocket:function(t){var e=this,r=new m.a("/branch/ws");this.stompClient=c.a.over(r),this.stompClient.connect({},(function(r){e.stompClient.subscribe("/topic/".concat(t),e.onMessageReceived)}))},onMessageReceived:function(t){this.chatListing.push(JSON.parse(t.body)),this.getAll()},setUsername:function(){this.username=this.inputUsername},sendMessage:function(){var t=this.message;if(t&&this.stompClient){var e={roomId:this.roomId,sender:this.me,receiver:this.roomId,content:t,type:"CHAT"};this.stompClient.send("/app/chat."+this.roomId+".sendMessage",{},JSON.stringify(e)),this.message="",this.getAll()}}}},h=r(15),component=Object(h.a)(v,(function(){var t=this,e=t._self._c;return e("div",{staticClass:"body-wrapper"},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"card overflow-hidden chat-application"},[t._m(0),t._v(" "),e("div",{staticClass:"d-flex"},[e("div",{staticClass:"w-30 d-none d-lg-block border-end user-chat-box"},[t._m(1),t._v(" "),e("div",{staticClass:"app-chat"},[e("ul",{staticClass:"chat-users simplebar-scrollable-y",staticStyle:{height:"calc(100vh - 350px)"},attrs:{"data-simplebar":"init"}},[e("div",{staticClass:"simplebar-wrapper",staticStyle:{margin:"0px"}},[t._m(2),t._v(" "),e("div",{staticClass:"simplebar-mask"},[e("div",{staticClass:"simplebar-offset",staticStyle:{right:"0px",bottom:"0px"}},[e("div",{staticClass:"simplebar-content-wrapper",staticStyle:{height:"100%",overflow:"hidden scroll"},attrs:{tabindex:"0",role:"region","aria-label":"scrollable content"}},[e("div",{staticClass:"simplebar-content",staticStyle:{padding:"0px"}},t._l(t.listing,(function(r){return e("li",{key:r.id+"chat"},[e("a",{staticClass:"px-4 py-3 bg-hover-light-black d-flex align-items-start justify-content-between chat-user text-bg-light",attrs:{href:"javascript:void(0)",id:"chat_user_1","data-user-id":"1"},on:{click:function(e){return t.getMessages(r)}}},[e("div",{staticClass:"d-flex align-items-center"},[t._m(3,!0),t._v(" "),e("div",{staticClass:"ms-3 d-inline-block w-75"},[e("h6",{staticClass:"mb-1 fw-semibold chat-title",attrs:{"data-username":"James Anderson"}},[t._v("\n                                  Customer "+t._s(r.chatRoomId)+"\n                                ")]),t._v(" "),r.sender==t.me?e("span",{staticClass:"fs-3 text-truncate text-body-color d-block"},[t._v("You: "+t._s(r.content)+"...")]):e("span",{staticClass:"fs-3 text-truncate text-body-color d-block"},[t._v(t._s(r.content)+"...")])])]),t._v(" "),e("p",{staticClass:"fs-2 mb-0 text-muted"},[t._v("\n                              "+t._s(t.ago(r.timestamp))+"\n                            ")])])])})),0)])])]),t._v(" "),e("div",{staticClass:"simplebar-placeholder",staticStyle:{width:"336px",height:"560px"}})]),t._v(" "),t._m(4),t._v(" "),t._m(5)])])]),t._v(" "),e("div",{staticClass:"w-70 w-xs-100 chat-container"},[e("div",{staticClass:"chat-box-inner-part h-100"},[t._m(6),t._v(" "),e("div",{staticClass:"chatting-box d-block"},[e("div",{staticClass:"p-9 border-bottom chat-meta-user d-flex align-items-center justify-content-between"},[e("div",{staticClass:"hstack gap-3 current-chat-user-name"},[t._m(7),t._v(" "),e("div",{},[e("h6",{staticClass:"mb-1 name fw-semibold"},[t._v("\n                      Customer "+t._s(this.roomId)+"\n                    ")]),t._v(" "),e("p",{staticClass:"mb-0"},[t._v("Away")])])]),t._v(" "),t._m(8)]),t._v(" "),e("div",{staticClass:"position-relative overflow-hidden d-flex"},[e("div",{staticClass:"position-relative d-flex flex-grow-1 flex-column"},[e("div",{staticClass:"chat-box p-9",staticStyle:{height:"calc(100vh - 300px)"},attrs:{"data-simplebar":"init"}},[e("div",{staticClass:"simplebar-wrapper",staticStyle:{margin:"-20px"}},[t._m(9),t._v(" "),e("div",{staticClass:"simplebar-mask"},[e("div",{staticClass:"simplebar-offset",staticStyle:{right:"0px",bottom:"0px"}},[e("div",{staticClass:"simplebar-content-wrapper",staticStyle:{height:"100%",overflow:"hidden scroll"},attrs:{tabindex:"0",role:"region","aria-label":"scrollable content"}},[e("div",{staticClass:"simplebar-content",staticStyle:{padding:"20px"}},[t.chatListing.length>0?e("div",{staticClass:"chat-list active"},t._l(t.chatListing,(function(r){return e("div",{key:r.id+"chat",staticClass:"hstack gap-3 align-items-start mb-7",class:{"justify-content-start":r.sender!=t.me,"justify-content-end":r.sender==t.me}},[r.sender!=t.me?e("div",{staticStyle:{display:"flex",gap:"1em"}},[e("img",{staticClass:"rounded-circle",attrs:{src:"/Modernize/images/profile/user-8.jpg",alt:"user8",width:"40",height:"40"}}),t._v(" "),e("div",[e("h6",{staticClass:"fs-2 text-muted"},[t._v("\n                                        Customer "+t._s(r.id)+",\n                                        "+t._s(t.ago(r.timestamp))+"\n                                      ")]),t._v(" "),e("div",{staticClass:"p-2 text-bg-light rounded-1 d-inline-block text-dark fs-3"},[t._v("\n                                        "+t._s(r.content)+"\n                                      ")])])]):e("div",{staticClass:"text-end"},[e("h6",{staticClass:"fs-2 text-muted"},[t._v("\n                                      "+t._s(t.ago(r.timestamp))+"\n                                    ")]),t._v(" "),e("div",{staticClass:"p-2 bg-info-subtle text-dark rounded-1 d-inline-block fs-3"},[t._v("\n                                      "+t._s(r.content)+"\n                                    ")])])])})),0):e("div",{staticClass:"chat-list active"},[e("p",{staticStyle:{position:"absolute",bottom:"0",right:"35%",color:"rgba(0, 0, 0, 0.6)"}},[t._v("\n                                  No message, you can write anything!\n                                ")])])])])])]),t._v(" "),e("div",{staticClass:"simplebar-placeholder",staticStyle:{width:"auto",height:"577px"}})]),t._v(" "),t._m(10),t._v(" "),t._m(11)]),t._v(" "),e("div",{staticClass:"px-9 py-6 border-top chat-send-message-footer"},[e("div",{staticClass:"d-flex align-items-center justify-content-between"},[e("div",{staticClass:"d-flex align-items-center gap-2 w-85"},[t._m(12),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"form-control message-type-box text-muted border-0 p-0 ms-2",attrs:{type:"text",placeholder:"Type a Message",fdprocessedid:"0p3op"},domProps:{value:t.message},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.sendMessage.apply(null,arguments)},input:function(e){e.target.composing||(t.message=e.target.value)}}})]),t._v(" "),e("ul",{staticClass:"list-unstyledn mb-0 d-flex align-items-center"},[e("li",[e("a",{staticClass:"text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5",attrs:{href:"javascript:void(0)"},on:{click:t.sendMessage}},[e("i",{staticClass:"ti ti-send"})])])])])])])])])])])])])])])}),[function(){var t=this,e=t._self._c;return e("div",{staticClass:"d-flex align-items-center justify-content-between gap-3 m-3 d-lg-none"},[e("button",{staticClass:"btn btn-primary d-flex",attrs:{type:"button","data-bs-toggle":"offcanvas","data-bs-target":"#chat-sidebar","aria-controls":"chat-sidebar"}},[e("i",{staticClass:"ti ti-menu-2 fs-5"})]),t._v(" "),e("form",{staticClass:"position-relative w-100"},[e("input",{staticClass:"form-control search-chat py-2 ps-5",attrs:{type:"text",id:"text-srh",placeholder:"Search Contact"}}),t._v(" "),e("i",{staticClass:"ti ti-search position-absolute top-50 start-0 translate-middle-y fs-6 text-dark ms-3"})])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"px-4 pt-9 pb-6"},[e("div",{staticClass:"d-flex align-items-center justify-content-between mb-3"},[e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"position-relative"},[e("img",{staticClass:"rounded-circle",attrs:{src:"/Modernize/images/allout.svg",alt:"user1",width:"54",height:"54"}})]),t._v(" "),e("div",{staticClass:"ms-3"},[e("h6",{staticClass:"fw-semibold mb-2"},[t._v("AllOut Customer Support")])])])]),t._v(" "),e("form",{staticClass:"position-relative mb-4"},[e("input",{staticClass:"form-control search-chat py-2 ps-5",attrs:{type:"text",id:"text-srh",placeholder:"Search Contact"}}),t._v(" "),e("i",{staticClass:"ti ti-search position-absolute top-50 start-0 translate-middle-y fs-6 text-dark ms-3"})]),t._v(" "),e("div",{staticClass:"dropdown"},[e("a",{staticClass:"text-muted fw-semibold d-flex align-items-center",attrs:{href:"javascript:void(0)",role:"button","data-bs-toggle":"dropdown","aria-expanded":"false"}},[t._v("\n                Recent Chats"),e("i",{staticClass:"ti ti-chevron-down ms-1 fs-5"})]),t._v(" "),e("ul",{staticClass:"dropdown-menu"},[e("li",[e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"}},[t._v("Sort by time")])]),t._v(" "),e("li",[e("a",{staticClass:"dropdown-item border-bottom",attrs:{href:"javascript:void(0)"}},[t._v("Sort by Unread")])]),t._v(" "),e("li",[e("a",{staticClass:"dropdown-item",attrs:{href:"javascript:void(0)"}},[t._v("Hide favourites")])])])])])},function(){var t=this._self._c;return t("div",{staticClass:"simplebar-height-auto-observer-wrapper"},[t("div",{staticClass:"simplebar-height-auto-observer"})])},function(){var t=this._self._c;return t("span",{staticClass:"position-relative"},[t("img",{staticClass:"rounded-circle",attrs:{src:"/Modernize/images/profile/user-1.jpg",alt:"user1",width:"48",height:"48"}})])},function(){var t=this._self._c;return t("div",{staticClass:"simplebar-track simplebar-horizontal",staticStyle:{visibility:"hidden"}},[t("div",{staticClass:"simplebar-scrollbar",staticStyle:{width:"0px",display:"none"}})])},function(){var t=this._self._c;return t("div",{staticClass:"simplebar-track simplebar-vertical",staticStyle:{visibility:"visible"}},[t("div",{staticClass:"simplebar-scrollbar",staticStyle:{height:"25px",transform:"translate3d(0px, 0px, 0px)",display:"block"}})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"chat-not-selected h-100 d-none"},[e("div",{staticClass:"d-flex align-items-center justify-content-center h-100 p-5"},[e("div",{staticClass:"text-center"},[e("span",{staticClass:"text-primary"},[e("i",{staticClass:"ti ti-message-dots fs-10"})]),t._v(" "),e("h6",{staticClass:"mt-2"},[t._v("Open chat from the list")])])])])},function(){var t=this._self._c;return t("div",{staticClass:"position-relative"},[t("img",{staticClass:"rounded-circle",attrs:{src:"/Modernize/images/profile/user-1.jpg",alt:"user1",width:"48",height:"48"}})])},function(){var t=this._self._c;return t("ul",{staticClass:"list-unstyled mb-0 d-flex align-items-center"},[t("li",[t("a",{staticClass:"chat-menu text-dark px-2 fs-7 bg-hover-primary nav-icon-hover position-relative z-index-5",attrs:{href:"javascript:void(0)"}},[t("i",{staticClass:"ti ti-menu-2"})])])])},function(){var t=this._self._c;return t("div",{staticClass:"simplebar-height-auto-observer-wrapper"},[t("div",{staticClass:"simplebar-height-auto-observer"})])},function(){var t=this._self._c;return t("div",{staticClass:"simplebar-track simplebar-horizontal",staticStyle:{visibility:"hidden"}},[t("div",{staticClass:"simplebar-scrollbar",staticStyle:{width:"0px",display:"none"}})])},function(){var t=this._self._c;return t("div",{staticClass:"simplebar-track simplebar-vertical",staticStyle:{visibility:"visible"}},[t("div",{staticClass:"simplebar-scrollbar",staticStyle:{height:"263px",transform:"translate3d(0px, 0px, 0px)",display:"block"}})])},function(){var t=this._self._c;return t("a",{staticClass:"position-relative nav-icon-hover z-index-5",attrs:{href:"javascript:void(0)"}},[t("i",{staticClass:"ti ti-mood-smile text-dark bg-hover-primary fs-7"})])}],!1,null,null,null);e.default=component.exports}}]);